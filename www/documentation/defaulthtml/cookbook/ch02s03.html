<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>2.3. Build Process</title><link rel="stylesheet" href="look-and-feel.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.49"><link rel="home" href="index.html" title="Cookbook for Developers of ArgoUML"><link rel="up" href="ch02.html" title="Chapter 2. Building from source"><link rel="previous" href="ch02s02.html" title="2.2. Download from the CVS repository"><link rel="next" href="ch02s04.html" title="2.4. Making a release"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2.3. Build Process</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02s02.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter 2. Building from source</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch02s04.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="Build"></a>2.3. Build Process</h2></div></div><a class="indexterm" name="d0e377"></a><a class="indexterm" name="d0e382"></a><p>
The ArgoUML build process is driven by ANT, and it is highly recommend
that you stick to that.
There are people known to build from JBuilder or Netbeans, but always
make sure that your work compile with the plain vanilla build process.
     </p><p>
Ant is a tool written in java developed for Apache that reads an xml-file
with rules telling what to compile to what result and what files to include
in what jar-file.
</p><a class="indexterm" name="d0e389"></a><p>
The rule file is named <tt>build.xml</tt>.
There is one of those in every separately built directory
(<tt>src_new</tt>,
<tt>documentation</tt>, and
<tt>modules/<i><tt>whatever</tt></i></tt>).
</p><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="d0e409"></a>2.3.1. How ANT is run from the ArgoUML development environment</h3></div></div><a class="indexterm" name="d0e412"></a><p>
For your convenience the ant tool of the correct version is present in the
CVS repository of ArgoUML in the file 
<tt>argouml/lib/ant.jar</tt>.
</p><p>
Normally ant is started with the command
<b>ant <i><tt>parameter</tt></i></b>
but the ArgoUML CVS repository does not contain that convenience program
so you would instead have to write:
<b>java -Dant.home=<i><tt>/your/checked/out/copy/of/argouml</tt></i> -classpath <i><tt>a:complex:classpath</tt></i> -jar ant.jar <i><tt>parameter</tt></i></b>.
</p><p>
To help you there are instead two scripts (one for Unix and one for
Windows) that are called <tt>build.sh</tt> and
<tt>build.bat</tt> respectively present in most
of the directories that contain a <tt>build.xml</tt> file.
These contain some definitions of classpath to simplify the setup.
All you have to do is to set the variables JAVA_HOME and ANT_HOME.
</p><p>
By setting JAVA_HOME to different values you can at different times
build with different versions of jdk and java.
</p><p>
By setting ANT_HOME to different values you can at different times
build with different versions of ant.
This does however not work in the Windows case because of
how <tt>build.bat</tt> is written.
</p><div class="sect3"><div class="titlepage"><div><h4 class="title"><a name="d0e458"></a>2.3.1.1. Compiling for Unix</h4></div></div><a class="indexterm" name="d0e461"></a><a class="indexterm" name="d0e466"></a><p>
Here is what you need to do in order to compile and run 
your checked out copy of ArgoUML under Unix.
</p><div class="orderedlist"><ol type="1"><li><p><b>JAVA_HOME=<i><tt>/where/you/have/installed/jdk</tt></i></b></p><p><b>export JAVA_HOME</b></p><p>
This is for sh-style shells like sh, ksh, zsh and bash. If you use
csh-style shells like csh and tcsh you will instead have to write
<b>setenv JAVA_HOME <i><tt>/where/you/have/installed/jdk</tt></i></b>.
</p></li><li><p>
Change the current directory to the directory you are building
</p><p>
<b>cd <i><tt>/your/checked/out/copy/of/argouml/src_new</tt></i></b>
</p></li><li><p>
Modify the beginning of the <tt>build.sh</tt> file 
by setting ARGO_HOME and ANT_HOME to the name
<i><tt>/your/checked/out/copy/of/argouml</tt></i>
</p></li><li><p>Start ant using <b>./build.sh</b></p><p>This gives you a list of targets with descriptions</p></li><li><p>
Compile and run Argouml using <b>./build.sh run</b>
</p><p>
You can do this over and over again when you have modified something
or want to compile and run again.
</p></li></ol></div></div><div class="sect3"><div class="titlepage"><div><h4 class="title"><a name="d0e524"></a>2.3.1.2. Compiling for Windows</h4></div></div><a class="indexterm" name="d0e527"></a><a class="indexterm" name="d0e532"></a><div class="orderedlist"><ol type="1"><li><p>
<b>set JAVA_HOME=<i><tt>/where/you/have/installed/jdk</tt></i></b>
</p></li><li><p>
<b>set ANT_HOME=<i><tt>/your/checked/out/copy/of/argouml</tt></i></b>
</p></li><li><p>Change the current directory to the directory you are building</p><p>
<b>chdir <i><tt>\your\checked\out\copy\of\argouml\src_new</tt></i></b>
</p></li><li><p>Start ant using <b>build</b></p><p>This gives you a list of targets with descriptions</p></li><li><p>
Compile and run Argouml using <b>build run</b>
</p><p>
You can do this over and over again when you have modified something
or want to compile and run again.
</p></li></ol></div></div><div class="sect3"><div class="titlepage"><div><h4 class="title"><a name="d0e579"></a>2.3.1.3. Building javadoc</h4></div></div><a class="indexterm" name="d0e582"></a><a class="indexterm" name="d0e587"></a><p>
By running ANT again using <b>build prepare-docs</b>
the javadoc documentation is generated and put into
<tt>argouml/build/javadocs</tt>.
</p><p>
Notice that you need to be connected to the Internet to do this since
the javadoc wants to test the availability of other javadoc sites in 
order to link to them. This is probably a problem with ANT 1.3.
</p></div></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="d0e602"></a>2.3.2. How documentation is presented</h3></div></div><p>
This describes how the documentation arrives on the web site.
</p><div class="sect3"><div class="titlepage"><div><h4 class="title"><a name="how_the_web_site_works"></a>2.3.2.1. How the ArgoUML web site works</h4></div></div><a class="indexterm" name="d0e610"></a><p>
Tigris provides the ArgoUML site to be edited through CVS. Everything
that is checked in under <tt>argouml/www</tt>
becomes immediatly available at the url 
<a href="http://argouml.tigris.org/" target="_top">http://argouml.tigris.org/</a>
with some added decorations left and up.
</p><p>
Example: The file <tt>argouml/www/project.html</tt> is
available at 
<a href="http://argouml.tigris.org/project.html" target="_top">http://argouml.tigris.org/project.html</a>.
</p><p>
This is the way the site is maintained and updated.
</p></div><div class="sect3"><div class="titlepage"><div><h4 class="title"><a name="d0e633"></a>2.3.2.2. The ArgoUML documentation</h4></div></div><a class="indexterm" name="d0e636"></a><a class="indexterm" name="d0e639"></a><p>
For the ArgoUML project the same documenation shall be available in both
html, pdf and javahelp. To this end the documentation is written in
docbook xml and generated into two versions of html 
(one page per chapter and one page for the whole book),
pdf and javahelp.
</p><p>
We have tools that does the conversion from docbook xml to html and pdf.
The conversion is done whenever you need to look at the result or when 
you want to present the final result on the web site.
</p><p>
There is currently three different books generated in this way, 
each its own directory. They are cookbook (this document), 
manual and quick-guide. They are all generated and stored in the
exact same way except for the name of the directory that is one
of <tt>cookbook</tt>,
<tt>manual</tt> or 
<tt>quick-guide</tt>.
Below I will reference this directory using 
<tt><i><tt>book</tt></i></tt>.
</p><p>
When a new version of the documentation is to be made available on the
web site the responsible document release person does the following:
</p><div class="orderedlist"><ol type="1"><li><p>
He checks out an updated copy of everything needed
and a copy of the <tt>argouml/www</tt>.
</p><p>
To be on the safe side, this could be the whole of ArgoUML.
</p><p>
If wanted, the CVS repository could be tagged and then the tag
can be checked out. This makes it possible to know exactly 
how a certain version of the documentation was generated.
</p></li><li><p>
The documentation is generated using <b>build docs</b>.
</p><p>
This generates all three books and the result appears in 
<tt>argouml/build/documentation/defaulthtml/<i><tt>book</tt></i></tt>,
<tt>argouml/build/documentation/printablehtml/<i><tt>book</tt></i></tt>, and
<tt>argouml/build/documentation/pdf/<i><tt>book</tt></i></tt>.
</p><p>
This has been done several times before while preparing the release so
no problems are expected. If there are problems then the preparations
was not good enough and the process is best stopped right here.
</p></li><li><p>
All the old files are removed from the checked out copy of 
<tt>argouml/www/documentation/defaulthtml/<i><tt>book</tt></i></tt>, 
<tt>argouml/www/documentation/printablehtml/<i><tt>book</tt></i></tt>.
</p></li><li><p>
New files are copied into the checked out copy of www
on top of the previous files there replacing them.
</p><p>
All the files are copied from
<tt>argouml/build/documentation/defaulthtml/<i><tt>book</tt></i></tt> to
<tt>argouml/www/documentation/defaulthtml/<i><tt>book</tt></i></tt>. 
The same for <tt>printablehtml</tt> and 
<tt>pdf</tt>.
</p></li><li><p>
No longer used files in 
<tt>argouml/www/documentation</tt>
are removed from CVS and new files are added.
</p><p><b>cvs -n update</b></p><p>Watch for "Missing" and "Unknown" files.</p><p>
The missing files are scheduled to be removed by:
<b>cvs remove <i><tt>each of the missing files</tt></i></b>
</p><p>
The "Unknown" files are scheduled to be added by:
<b>cvs add <i><tt>each of the added files</tt></i></b>
</p><p>
This removing of missing files and adding of unknown files may seem
backward but it is from the perspective of CVS.
The missing files are the ones that were present in the previous
version of the documentation and that does not have a replacement,
either because that chapter does not exist anymore or that the tool
generate filenames differently.
The Unknown files are files with filenames that for the same reason
appear from one version of the documentation to the next.
</p></li><li><p>
Commit the changes thus publishing it on the web site.
</p><p>
<b>cvs commit -m'New version of the documentation published'</b>
</p></li><li><p>
The pdf book is uploaded to the download page.
</p></li></ol></div></div><div class="sect3"><div class="titlepage"><div><h4 class="title"><a name="d0e773"></a>2.3.2.3. How developers work with documentation</h4></div></div><a class="indexterm" name="d0e776"></a><p>
Developers that work with the documentation or with the tools 
to generate the documentation (or anyone else interested in this)
can generate the documentation like described above and examine
the result in
<tt>argouml/build</tt>.
It is only the last part about checking in and upploading the result
under
<tt>argouml/www/documentation</tt>
that requires write access in the CVS and synchronisation with the
rest of the project.
</p><p>
In order to do this you need to check out the whole of the
<tt>argouml/documentation</tt> directory.
You also need the directory
<tt>argouml/lib</tt> and
<tt>argouml/tools</tt>
that contains the tools used: ANT, Fop, saxon, ...
</p><p>
The subdirectories of
<tt>argouml/documentation</tt>,
<tt>cookbook</tt>,
<tt>manual</tt>, and
<tt>quick-guide</tt>
each contain one of the four books.
The subdirectory
<tt>docbook-setup</tt>
contains two things. 
It contains the configuration files that control how the generation is done.
It contains the xsl rules for all the generation.
The subdirectory
<tt>images</tt>
contains all the required pictures for all the books.
</p></div></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="d0e820"></a>2.3.3. Troubleshooting the development build</h3></div></div><a class="indexterm" name="d0e823"></a><div class="sect3"><div class="titlepage"><div><h4 class="title"><a name="d0e828"></a>2.3.3.1. Compiling failed. Any suggestions?</h4></div></div><p>
It might be that some other developer has made a misstake in checking
in things that contains error, or forgotten to check in some files
in a change.
Look at the last couple of hours on the
<a href="http://argouml.tigris.org/servlets/BrowseList?listName=dev" target="_top">
developers mailing list</a>!
It is probably on fire.
</p><p>
Another reason for problems is an unclean local source tree.
This means that if you have updated different parts of your source 
tree at different times it might contains inconsistencies.
If you suspect this, first try fix it by doing
<b>build clean</b> and <b>cvs update -d</b>
before trying to build again.
If that doesn't work remove your checked out copy completely and 
get it all again through CVS.
</p><p>
Another reason might be that you have an .ant.properties or
.argo.ant.properties file that you have been working with earlier
and that is doing something. If in doubt, remove those files.
</p><p>
If nothing helps, ask the 
<a href="mailto:dev@argouml.tigris.org" target="_top">developers mailing list</a>!
</p></div><div class="sect3"><div class="titlepage"><div><h4 class="title"><a name="d0e851"></a>2.3.3.2. Can't commit my changes?</h4></div></div><a class="indexterm" name="d0e854"></a><p>
You need to have a developer role in the ArgoUML project.
If you don't then you cannot do commit yourself.
Discuss what you have done and how best to test it on the
<a href="mailto:dev@argouml.tigris.org" target="_top">developers mailing list</a>!
Eventually someone will commit it for you.
</p><p>
Furthermore the checkout of your copy need to be done with your
tigris id that has the Developer role.
If you for some reason have earlier checked out
a copy as guest and then made modifications, changed the CVSROOT
variable you still cannot commit changes done in the repository since the
checked out copy contains information on who checked out.
For this reason, it is best to apply for an Observer role in 
the project if you are going to work with the source at all.
The Observer role is probably granted within a couple of days
(we welcome everybody!) and then you can check out with your tigris id.
This means that when you eventually are granted a Developer role you
can continue working with the same checked out copy.
</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02s02.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch02.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch02s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">2.2. Download from the CVS repository&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;2.4. Making a release</td></tr></table></div></body></html>