<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>5.18.&nbsp;Explorer</title><link rel="stylesheet" href="look-and-feel.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.66.1"><link rel="start" href="index.html" title="Cookbook for Developers of ArgoUML"><link rel="up" href="ch05.html" title="Chapter&nbsp;5.&nbsp;Inside the subsystems"><link rel="prev" href="ch05s17.html" title="5.17.&nbsp;To do items"><link rel="next" href="ch05s19.html" title="5.19.&nbsp;Module loader"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.18.&nbsp;Explorer</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch05s17.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;5.&nbsp;Inside the subsystems</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch05s19.html">Next</a></td></tr></table><hr></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="explorer"></a>5.18.&nbsp;Explorer</h2></div></div></div><a class="indexterm" name="d0e7507"></a><a class="indexterm" name="d0e7510"></a><a class="indexterm" name="d0e7513"></a><p> Purpose - to provide tree views of the model elements, diagrams and
      other objects. Note: the Explorer used to be called the Navigator. </p><p> The Explorer is located in
      <tt class="classname">org.argouml.ui.explorer</tt> and sub-packages.
      </p><p> The Explorer is a Layer 2 subsystem. See <a href="ch04s05.html" title="4.5.&nbsp;View and Control subsystems">Section&nbsp;4.5, &#8220;View and Control subsystems&#8221;</a>. </p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7527"></a>5.18.1.&nbsp;Requirements</h3></div></div></div><p> The Explorer must react to user and application events. </p><p> User events include
        </p><div class="itemizedlist"><ul type="disc" compact><li><p> R1: selection of a node, which must notify the other views to
              make the same selection. </p></li><li><p> R2: right click on a node, which brings up a pop-up menu.
              </p></li><li><p> R3: selection of another perspective in the Combo box, which
              must change the explorer to that perspective. A perspective
              provides a different view of the model that will focus on one or
              other part of the model. </p></li><li><p> R4: node expansion and collapse. </p></li><li><p> R5: It is possible to drag name-space nodes on to other
              name-space nodes. Dropping a name-space node onto another, will,
              if the destination name-space is a valid one, update the explorer
              and model. </p></li><li><p> R6: sorting of nodes with a particular Ordering. [an ordering
              is a comparator that orders child nodes in the explorer, e.g. by
              name and/or type]. </p></li><li><p> R7: copy diagram to clipboard functionality for
              windows/java 1.4 users. </p></li><li><p> R8: tool-tip showing node name and type. </p></li><li><p> R9: standard multiple discontinuous selection with mouse
              and keyboard. </p></li><li><p> R10: the user can configure the perspectives using a dialog.
              Perspectives can be added, deleted, renamed, reordered and
              duplicated. Perspective rules can be added and removed from a
              perspective. The changes are saved to the user properties. If
              there are user perspectives when ArgoUML starts, it loads these,
              otherwise it loads a default set of perspectives. </p></li></ul></div><p> </p><p> Application events include
        </p><div class="itemizedlist"><ul type="disc" compact><li><p> R11: change in selection in another view, any relevant rows to
              be highlighted. </p></li><li><p> R12: the UML model changes, the tree must update to reflect
              additions/deletions and name changes in the model. </p></li><li><p> R13: change of project, the tree must update. the root node
              should be expanded with the default diagram selected. </p></li></ul></div><p> </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7579"></a>5.18.2.&nbsp;Public APIs and SPIs</h3></div></div></div><p> The Explorer Subsystem provides/will provide the following APIs:
        </p><div class="itemizedlist"><ul type="disc" compact><li><p> API1: Addition / Removal of a Perspective from the
              PerspectiveManager. Status: implemented </p></li><li><p> API2: Addition / Removal of a Perspective Rule from a
              Perspective. Status: implemented </p></li><li><p> API3: Selection of the Perspective to be displayed by the
              Explorer. Status: not implemented </p></li><li><p> API4: Selection of Ordering for Explorer nodes. [an Ordering
              is a comparator that orders child nodes in the Explorer] Status:
              not implemented </p></li></ul></div><p> </p><p> The Explorer Subsystem provides/will provide the following SPIs:
        </p><div class="itemizedlist"><ul type="disc" compact><li><p> SPI1: Configurable Node pop-up menu. Status: not
              implemented </p></li><li><p> SPI2: New PerspectiveRules can be defined and registered
              with the 'library' of available rules. Status: not implemented
              </p></li><li><p> SPI3: New Orderings can be defined and registered with the
              available orderings. [an ordering is a comparator that orders
              child nodes in the explorer] Status: not implemented </p></li></ul></div><p> </p><p> The APIs collectively represent the Explorer subsystem facade and
        the SPIs represent plug-ins. </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="explorer-implementation-details"></a>5.18.3.&nbsp;Details of the Explorer Implementation</h3></div></div></div><p> The Explorer is currently shown in the Explorer Pane
        (<tt class="classname">org.argouml.ui.NavigatorPane</tt>) - the upper
        left hand pane of ArgoUML. </p><p> Except for the Explorer Pane, The Explorer is located in
        org.argouml.ui.explorer.*. The explorer has been refactored since
        version 0.15.2 so that it has a slightly more standard Java Swing
        implementation. </p><p> The explorer perspectives provide the different views of the
        project. They are implemented by sets of PerspectiveRules that get the
        child nodes for any parent node in the tree. </p><p>
        </p><div class="mediaobject"><img src="images/cookbook/explorer-architecture.gif"></div><p> </p><p> The Explorer has 3 main subcomponents: a customized JTree, a
        customized TreeModel and an interface for generating child nodes in the
        tree which forms the tree Perspective.
        </p><div class="orderedlist"><ol type="1" compact><li><p> The JTree (org.argouml.ui.explorer.ExplorerTree) has
              been customized to maintain consistent selection state with the
              other model views. It provides a pop up menu (ExplorerPopup) for
              performing actions on specific model elements. There is specific
              functionality in DnDExplorerTree for Drag and drop, and in
              ExportExplorer for copy diagram to clipboard. </p></li><li><p> The TreeModel is a customized DefaultTreeModel that listens
              to changes in the UML model. The JTree builds the tree model as the
              user expands nodes, this minimizes the size of the model to those
              part that the user is interested in. The TreeModel contains custom
              DefaultMutableTreeNodes, ExplorerTreeNodes, that maintain
              their own order on child nodes; this will typically be an
              alphabetical order on the model element names. However, it could
              be enhanced to include more powerful orders like total subtree
              size. </p></li><li><p> The model uses the third part of the Explorer design,
              PerspectiveRules, to add child nodes to the leaves of the tree. The
              structure of the tree is wholly dependent on the collection of
              PerspectiveRules that together provide a specialized view of the
              UML model. This is very flexible and extensible. The
              org.argouml.ui.explorer.rules package contains a default set
              of PerspectiveRules. </p></li></ol></div><p> </p><p> Each node is displayed with a name and an Icon, representing the type
        of node it is in the UML model. This is done using the
        <tt class="classname">org.argouml.uml.ui.UMLTreeRenderer</tt> (for
        the Icon), and the text is produced in the
        <tt class="methodname">convertValueToText(...)</tt> method in
        <tt class="classname">org.argouml.ui.explorer.ExplorerTree</tt>.
        </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7655"></a>5.18.4.&nbsp;How do I ...?</h3></div></div></div><p>
        </p><div class="itemizedlist"><ul type="disc"><li><p>...add another perspective?</p><p>
              </p><div class="itemizedlist"><ul type="circle"><li><p> The perspectives can be configured using the
                    <tt class="classname">org.argouml.ui.explorer.PerspectiveConfigurator</tt>
                    by the User. The changes to the pre-defined built-in
                    defaults are stored in the
                    <tt class="filename">argo.user.properties</tt>
                    file.</p></li><li><p> If you want to do this as part of an extension to ArgoUML
                    then you should use (see above) APIs 1,2 and 3, and SPI 2. The
                    functions needed are present in the
                    <tt class="classname">PerspectiveManager</tt>. </p></li></ul></div><p> </p></li><li><p>...improve the PopUp menu?</p><p> There is no way of doing this currently without modifying the
              core of ArgoUML. You could use SPI1 when it gets implemented.
              </p></li><li><p>...extend the Explorer in other ways?</p><p> The best way is to use the above APIs/SPIs; if they are not
              implemented then it would be best to implement them and feedback
              your improvements to the ArgoUML project so that your code works on
              a recognized public API that will be maintained in the future.
              </p></li><li><p>...add new rules for new model elements?</p><p> You should create a GoRule/PerspectiveRule in
              </p><div class="address"><p>org/argouml/ui/explorer/rules</p></div><p>. There
              are plenty of examples to look at. The important things to get right
              is of course that:</p><p>
              </p><div class="itemizedlist"><ul type="circle"><li><p> you return the right children</p></li><li><p> return the objects that the TreeModel must
                  listen to to know when to update the node (and the list of
                  immediate children) After that you must register your GoRule
                  in org/argouml/ui/explorer/PerspectiveManager</p></li><li><p> add it to the list in loadRules()</p></li><li><p> perhaps add it to some of the default
                  perspectives in oldLoadDefaultPerspectives(), I guess And
                  then I think it should just be a matter of recompiling and
                  possibly switching to the perspective you added your rule
                  to.</p></li></ul></div><p> </p></li><li><p>...tell the explorer to refresh?</p><p> You are not supposed to. The TreeModel is supposed to listen to
              events and refresh affected parts. And this is where the lack of
              events for adding diagrams creates a problem. </p><p> Obviously it would be possible to add an operation somewhere
              to revalidate the expanded parts of the Explorer, but I'm not aware
              of the existence of such an operation today. </p></li><li><p>...navigate programmatically to a certain explorer element
              so that its path is exploded?</p><p>In general you can't. The Explorer tree is lazy in that it only
              explores the parts of the tree that the user has opened. And since
              the GoRules are general navigating to them would require a
              complete tree search. Which is also complicated by the fact that
              the answer is not unique and there can be branches with infinite
              depth. </p><p> In reality it would be possible to create an algorithm to
              search out one occurrence of an element (since the model only
              contains finitely many elements and I assume that no-one will add
              go rules that add branches of infinite length that does not
              infinitely often contain elements from the model), but I don't
              think anyone has don't it. Obviously finding all occurrences
              cannot be done. </p></li></ul></div><p> </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch05s17.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch05.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch05s19.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">5.17.&nbsp;To do items&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;5.19.&nbsp;Module loader</td></tr></table></div></body></html>